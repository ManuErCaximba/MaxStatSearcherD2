"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2689],{2689:(le,O,c)=>{c.r(O),c.d(O,{BuildSearcherPageModule:()=>te});var v=c(6895),a=c(4719),l=c(7479),I=c(2667),N=c(5861),y=c(4089),x=c(5117),e=c(6738),w=c(9355),U=c(1407),B=c(2634);function F(i,n){if(1&i&&(e.TgZ(0,"ion-select-option",8),e._uU(1),e.qZA()),2&i){const t=n.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function J(i,n){if(1&i&&(e.TgZ(0,"div")(1,"ion-select-option",8),e._uU(2),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("value",t),e.xp6(1),e.hij(" ",t," ")}}function L(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,J,3,2,"div",10),e.qZA()),2&i){const t=n.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.statsSelected.indexOf(t)<0)}}function q(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"ion-item")(2,"ion-select",9),e.NdJ("ionChange",function(s){const m=e.CHM(t).$implicit,h=e.oxw();return e.KtG(h.addValue(s,m))}),e.YNc(3,L,2,1,"div",4),e.qZA()()()}if(2&i){const t=n.$implicit,o=e.oxw();e.xp6(2),e.MGl("formControlName","stat",t+1,""),e.s9C("selectedText",o.statsSelected[t]),e.MGl("placeholder","Stat ",t+1,""),e.xp6(1),e.Q6J("ngForOf",o.statsList)}}function D(i,n){if(1&i){const t=e.EpF();e.TgZ(0,"ion-toggle",17),e.NdJ("ionChange",function(){e.CHM(t);const s=e.oxw().$implicit,g=e.oxw();return e.KtG(g.setValue(s[0]))}),e.qZA()}}function H(i,n){if(1&i&&(e.TgZ(0,"div",13),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t)}}function M(i,n){if(1&i&&(e.TgZ(0,"ion-col",18),e.YNc(1,H,2,1,"div",19),e.qZA()),2&i){const t=n.index,o=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.Q6J("ngIf","COSECHADORA DE CARGA"==o[0]&&s.checkCosCharg(t)||"COSECHADORA DE CARGA"!=o[0])}}function Y(i,n){if(1&i&&(e.TgZ(0,"ion-row",11)(1,"ion-col",12)(2,"div",13),e._uU(3),e.qZA()(),e.TgZ(4,"ion-col",14),e.YNc(5,D,1,0,"ion-toggle",15),e.qZA(),e.YNc(6,M,2,1,"ion-col",16),e.qZA()),2&i){const t=n.$implicit,o=n.index;e.xp6(3),e.Oqu(t[0]),e.xp6(2),e.Q6J("ngIf",0!=o),e.xp6(1),e.Q6J("ngForOf",t.slice(1,t.length))}}function Q(i,n){if(1&i&&(e.TgZ(0,"div")(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-range",20)(4,"div",21),e._uU(5,"-20"),e.qZA(),e.TgZ(6,"div",22),e._uU(7,"20"),e.qZA()()()),2&i){const t=e.oxw(),o=t.$implicit,s=t.index;e.xp6(2),e.Oqu(o),e.xp6(1),e.MGl("formControlName","fragment",s+1,"")}}function G(i,n){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Q,8,2,"div",10),e.qZA()),2&i){const t=n.$implicit;e.xp6(1),e.Q6J("ngIf",null!=t)}}function $(i,n){if(1&i&&(e.TgZ(0,"ion-label",22),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("MOV: ",t.mobility,"")}}function k(i,n){if(1&i&&(e.TgZ(0,"ion-label",22),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("RES: ",t.resilience,"")}}function V(i,n){if(1&i&&(e.TgZ(0,"ion-label",22),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("REC: ",t.recovery,"")}}function j(i,n){if(1&i&&(e.TgZ(0,"ion-label",22),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("DIS: ",t.discipline,"")}}function z(i,n){if(1&i&&(e.TgZ(0,"ion-label",22),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("INT: ",t.intellect,"")}}function X(i,n){if(1&i&&(e.TgZ(0,"ion-label",22),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij("FUE: ",t.strength,"")}}function K(i,n){if(1&i&&(e.TgZ(0,"ion-col",23)(1,"ion-item")(2,"ion-thumbnail",21),e._UZ(3,"img",24),e.qZA(),e.TgZ(4,"ion-label"),e._uU(5),e.qZA(),e.YNc(6,$,2,1,"ion-label",25),e.YNc(7,k,2,1,"ion-label",25),e.YNc(8,V,2,1,"ion-label",25),e.YNc(9,j,2,1,"ion-label",25),e.YNc(10,z,2,1,"ion-label",25),e.YNc(11,X,2,1,"ion-label",25),e._UZ(12,"input",26),e.qZA()()),2&i){const t=n.$implicit,o=e.oxw();e.xp6(3),e.s9C("src",t.iconURL,e.LSH),e.xp6(2),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",o.statsSelected.indexOf("MOVILIDAD")>=0),e.xp6(1),e.Q6J("ngIf",o.statsSelected.indexOf("RESISTENCIA")>=0),e.xp6(1),e.Q6J("ngIf",o.statsSelected.indexOf("RECUPERACION")>=0),e.xp6(1),e.Q6J("ngIf",o.statsSelected.indexOf("DISCIPLINA")>=0),e.xp6(1),e.Q6J("ngIf",o.statsSelected.indexOf("INTELECTO")>=0),e.xp6(1),e.Q6J("ngIf",o.statsSelected.indexOf("FUERZA")>=0),e.xp6(1),e.Q6J("value",t)}}const W=[{path:"",component:(()=>{class i{constructor(t,o,s,g){this.restService=t,this.opService=o,this.router=s,this.dataService=g,this.armorsList=[],this.indexes=[0,1,2],this.statsList=["MOVILIDAD","RESISTENCIA","RECUPERACION","DISCIPLINA","INTELECTO","FUERZA"],this.statsSelected=[null,null,null],this.classList=["TITAN","CAZADOR","HECHICERO"],this.modList=[["","MOVILIDAD","RESISTENCIA","RECUPERACION","DISCIPLINA","INTELECTO","FUERZA"],["COSECHADORA DE CARGA","-10","-10","-10","","",""],["CONVERSOR DE ENERGIA","","","","-10","",""],["RESERVAS EXTRA","","","","","-10",""],["AMISTADES PODEROSAS","+20","","","","",""],["CARGA CON PRECISION","","","","-10","",""],["CARGA DE PRECISION","","","","","","-10"],["LUZ PROTECTORA","","","","","","-10"],["LUZ RADIANTE","","","","","","+20"],["CARGA Y RECARGA","","","-10","","",""],["ATAQUE SORPRESA","","","","","-10",""]]}ngOnInit(){var t=this;return(0,N.Z)(function*(){t.statForm=new a.cw({class:new a.NI(""),stat1:new a.NI(""),stat2:new a.NI(""),stat3:new a.NI(""),mods:new a.NI([]),fragment1:new a.NI(""),fragment2:new a.NI(""),fragment3:new a.NI(""),exotic:new a.NI("")});let o=yield t.restService.getCurrentUser().toPromise(),s=o.Response.destinyMemberships[0].membershipType,g=o.Response.destinyMemberships[0].membershipId,m=yield t.restService.getProfile(s,g).toPromise();console.log(m);let h=m.Response.profile.data.characterIds,d=[];for(let r=0;r<3;r++){let p=[];p=[...p,...m.Response.characterEquipment.data[h[r]].items],p=[...p,...m.Response.characterInventories.data[h[r]].items],d=d.concat(p)}d=d.concat(m.Response.profileInventory.data.items),console.log(d);let _=[];d.forEach(r=>{("14239492"==r.bucketHash||"3448274439"==r.bucketHash||"3551918588"==r.bucketHash||"20886954"==r.bucketHash||"138197802"==r.bucketHash)&&_.push(r)}),console.log(_);let u=[];_.forEach(r=>{u.push(r.itemInstanceId)}),console.log(u),t.restService.getItemManifestInfo().then(r=>{u.forEach(function(){var p=(0,N.Z)(function*(C){let Z=yield t.restService.getItem(s,g,C).toPromise(),S=Z.Response.item.data.itemHash,T=r[S.toString()].inventory,A=T.bucketTypeHash;if("14239492"==A||"3448274439"==A||"3551918588"==A||"20886954"==A){let ie="Exotic"===T.tierTypeName||"Excepcional"===T.tierTypeName,oe=r[S.toString()].classType,R=Z.Response.sockets.data.sockets.slice(6,10),P=Z.Response.item.data.overrideStyleItemHash,ne=void 0!==P?r[P.toString()].displayProperties.icon:r[S.toString()].displayProperties.icon,re=r[S].displayProperties.name,b=[];for(let E=0;E<R.length;E++){let ae=r[R[E].plugHash.toString()].investmentStats;b.push(ae)}let f=t.getStats(b),se=t.getArmorType(T.bucketTypeHash);t.armorsList.push(new y.G(C,S,re,"https://www.bungie.net"+ne,f[0],f[1],f[2],f[3],f[4],f[5],se,oe,ie))}});return function(C){return p.apply(this,arguments)}}())}),console.log(t.armorsList)})()}setValue(t){let o=[],s=this.statForm.get("mods").value;s.indexOf(t)<0?(o=[...o,...s],o=[...o,t],this.statForm.controls.mods.setValue(o)):(o=s,o.splice(o.indexOf(t),1),this.statForm.controls.mods.setValue(o))}onSubmit(){this.dataService.setData(1,this.opService.calc(this.statForm,this.armorsList)),this.router.navigate(["/result"])}getExoticsFromClass(){let t=[];for(let o=0;o<this.armorsList.length;o++)this.armorsList[o].isExotic&&this.classList.indexOf(this.getClassValue())==this.armorsList[o].classType&&t.push(this.armorsList[o]);return t.sort((o,s)=>o.name<s.name?-1:o.name>s.name?1:0),t}addValue(t,o){this.statsSelected[o]=t.detail.value}checkCosCharg(t){let o=this.getClassValue();return"CAZADOR"==o&&0==t||"TITAN"==o&&1==t||"HECHICERO"==o&&2==t}getClassValue(){return this.statForm.get("class").value}getStats(t){var o=0,s=0,g=0,m=0,h=0,d=0;for(let _=0;_<t.length;_++){let u=t[_];for(let r=0;r<3;r++)switch(u[r].statTypeHash){case 2996146975:o+=u[r].value;break;case 392767087:s+=u[r].value;break;case 1943323491:g+=u[r].value;break;case 1735777505:m+=u[r].value;break;case 144602215:h+=u[r].value;break;case 4244567218:d+=u[r].value}}return[o,s,g,m,h,d]}getArmorType(t){switch(t){case 3448274439:return x.Jf.HELMET;case 14239492:return x.Jf.CHEST;case 3551918588:return x.Jf.GAUNTLETS;case 20886954:return x.Jf.LEGS}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(w.v),e.Y36(U.p),e.Y36(I.F0),e.Y36(B.D))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-build-searcher"]],decls:29,vars:6,consts:[[1,"container"],[3,"formGroup","ngSubmit"],["formControlName","class"],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","ion-align-items-center",4,"ngFor","ngForOf"],["size","6",4,"ngFor","ngForOf"],["type","submit"],[3,"value"],[3,"formControlName","selectedText","placeholder","ionChange"],[4,"ngIf"],[1,"ion-align-items-center"],["size","2.5"],[1,"center-text"],["size","0.5"],[3,"ionChange",4,"ngIf"],["size","1.5",4,"ngFor","ngForOf"],[3,"ionChange"],["size","1.5"],["class","center-text",4,"ngIf"],["min","-20","max","20","step","10","pin","true","snaps","true",3,"formControlName"],["slot","start"],["slot","end"],["size","6"],[3,"src"],["slot","end",4,"ngIf"],["slot","end","name","exotic","type","radio","formControlName","exotic",1,"checkmark",3,"value"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Build Searcher"),e.qZA()()(),e.TgZ(4,"ion-content")(5,"div",0)(6,"form",1),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(7,"h4"),e._uU(8,"Clase"),e.qZA(),e.TgZ(9,"ion-item")(10,"ion-select",2),e.YNc(11,F,2,2,"ion-select-option",3),e.qZA()(),e.TgZ(12,"h4"),e._uU(13,"Stats"),e.qZA(),e.YNc(14,q,4,4,"div",4),e.TgZ(15,"h4"),e._uU(16,"Mods"),e.qZA(),e.TgZ(17,"ion-grid"),e.YNc(18,Y,7,3,"ion-row",5),e.qZA(),e.TgZ(19,"h4"),e._uU(20,"Fragmentos"),e.qZA(),e.YNc(21,G,2,1,"div",4),e.TgZ(22,"h4"),e._uU(23,"Excepcional"),e.qZA(),e.TgZ(24,"ion-grid")(25,"ion-row"),e.YNc(26,K,13,9,"ion-col",6),e.qZA()(),e.TgZ(27,"ion-button",7),e._uU(28,"Submit"),e.qZA()()()()),2&t&&(e.xp6(6),e.Q6J("formGroup",o.statForm),e.xp6(5),e.Q6J("ngForOf",o.classList),e.xp6(3),e.Q6J("ngForOf",o.indexes),e.xp6(4),e.Q6J("ngForOf",o.modList),e.xp6(3),e.Q6J("ngForOf",o.statsSelected),e.xp6(5),e.Q6J("ngForOf",o.getExoticsFromClass()))},dependencies:[v.sg,v.O5,a._Y,a.Fj,a._,a.JJ,a.JL,a.sg,a.u,l.YG,l.wI,l.W2,l.jY,l.Gu,l.Ie,l.Q$,l.I_,l.Nd,l.t9,l.n0,l.Bs,l.ho,l.sr,l.wd,l.w,l.QI],styles:[".center-toogle[_ngcontent-%COMP%]{margin:auto}.center-text[_ngcontent-%COMP%]{text-align:center}.checkmark[_ngcontent-%COMP%]{position:relative;margin-left:1em;top:0;left:0;height:25px;width:25px;background-color:#eee;border-radius:50%}"]}),i})()}];let ee=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[I.Bz.forChild(W),I.Bz]}),i})(),te=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[v.ez,a.u5,a.UX,l.Pc,ee]}),i})()}}]);